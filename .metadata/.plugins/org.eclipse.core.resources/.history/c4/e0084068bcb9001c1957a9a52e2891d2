package com.animals.controllers;

import java.util.List;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.crossstore.ChangeSetPersister.NotFoundException;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.bind.annotation.RestController;
import com.animals.DAO.SeguimientoDAO;
import com.animals.DAO.SolicitudAnimalDAO;
import com.animals.models.SeguimientoModel;

@RestController
public class SolicitudAnimalController {
	@Autowired
	SolicitudAnimalDAO requestDao;

	@GetMapping("/listarSolicitudes")
	@ResponseBody
	public List<SeguimientoModel> listarSolicitudes() {
		return requestDao.getAll();
	}

	@GetMapping("/listarSolicitudesDeUnUsuario/{nombreUsuario}")
	@ResponseBody
	public List<SeguimientoModel> listarSolicitudesDeUnUsuario(@PathVariable String nombreUsuario) throws NotFoundException {
		if (nombreUsuario == "") {
			throw new NotFoundException();
		}
		return requestDao.getSolicitudesDeUnUsuario(nombreUsuario);
	}
	
	@GetMapping("/listarFollowers/{nombreUsuario}")
	@ResponseBody
	public List<SeguimientoModel> listarFollowers(@PathVariable String nombreUsuario) throws NotFoundException {
		if (nombreUsuario == "") {
			throw new NotFoundException();
		}
		return requestDao.getFollowers(nombreUsuario);
	}

	@DeleteMapping("/borrarSeguimiento/{nombreUsuario1}/{nombreUsuario2}")
	@ResponseBody
	public void borrarSeguimiento(@PathVariable String nombreUsuario1 , @PathVariable String nombreUsuario2 ) throws NotFoundException {
		if (nombreUsuario1 == "" || nombreUsuario2 == "" ) {
			throw new NotFoundException();
		}
		requestDao.delete(nombreUsuario1,nombreUsuario2);
	}

	
	@PostMapping("/crearSeguimiento")
	@ResponseBody
	public void crearSeguimiento(@RequestBody SeguimientoModel follow) {
		requestDao.create(follow);
	}

}
